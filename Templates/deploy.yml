parameters:
  environment: 'dev'
  buildConfiguration: 'Release'
  appName: 'WebAppNameDev'
  stageName: 'Dev'
  dependsOn: Build
  condition: 'true'

stages:
- stage: '${{ parameters.stageName }}'
  displayName: 'Deploy to the ${{ parameters.environment }} environment'
  dependsOn: ${{ parameters.dependsOn }}
  condition: ${{ parameters.condition }}
  jobs:
    - deployment: Deploy
      pool:
        vmImage: 'ubuntu-16.04'
      environment: ${{ parameters.environment }}
      variables:
        - group: 'Release'
      strategy:
        runOnce:
          deploy:
            steps:
              - download: current
                artifact: drop
              - task: AzureWebApp@1
                displayName: 'Azure App Service deploy: website'
                inputs:
                  azureSubscription: 'Resource Manager - Tailspin - Space Game'
                  appName: '${{ parameters.appName }}'
                  package: '$(Pipeline.Workspace)/drop/${{ parameters.buildConfiguration }}/*.zip'
